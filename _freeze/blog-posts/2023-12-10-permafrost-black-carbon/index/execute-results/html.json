{
  "hash": "0ab678fc460c21c07e404abddc31d97c",
  "result": {
    "markdown": "---\ntitle: \"Soil Temperature Analysis at Toolik Field Station, AK\"\ndescription: \"Exploring the relationship between soil temperatures, air temperatures, and black carbon levels at Toolik Field Station, AK \"\nauthor:\n  - name: Melissa Widas\n    url: http://mwidas.github.io\n    affiliation: MEDS\n    affiliation-url: http://ucsb-meds.github.io\ndate: 2023-12-01\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show Code!\"\ncode-overflow: wrap\ncode-block-bg: true\ncode-block-border-left: \"#6B5A75\"\ncategories: [MEDS, Statistics, R]\ncitation: \n  url: http://mwidas.github.io/2023-12-10-permafrost-black-carbon\nimage: toolik_sign.jpeg\ndraft: false\nbibliography: references.bib\n---\n\n\n## Background\n\nSoil is all around us. Underneath our homes, creating landscapes and environments we like to recreate in and also a vital carbon sink. Soil, and especially permafrost soils, play a key role in storing greenhouse gases and releasing greenhouse gases as they warm. A permafrost soil is defined as a frozen soil that is at or below zero degrees celcius, and has been for at least two years [@nationalsnowandicedatacenter]. Climate change and climate change modeling varies widely on predicting the fate and impacts of permafrost soils [@zhu2019], but what are some of the main drivers behind permafrost melt?\n\nUltimately, the main driver behind permafrost melt is temperature. And the obvious thought is of course a warmer temperature will lead to warmer soil temperatures which will ultimately warm permafrost soils to the point where they are no longer frozen. As a broad overview this thought process works, however there are other drivers that determine soil temperature. Soil properties such as soil organic carbon, soil texture, bulk density, and soil moisture all impact how soils respond to temperature. However, it has been shown that soil organic carbon can be the dominant determinant of soil temperature in permafrost soils [@zhu2019]. One way soils build up soil organic carbon is through the deposition of black carbon [@kopeck√Ω2021].\n\nBlack carbon is predominantly present as products of incomplete combustion [@environmentalprotectionagency2016] . By incomplete combustion I am referring to soot from wildfires, fossil fuels, and biofuels.\n\nTherefore a question that comes to mind with these findings are if air temperature and black carbon levels both affect soil temperature can they predict soil temperature and in the process are air temperature and black carbon interacting with each other?\n\nTo explore this question further data from Toolik Field Station, AK will be explored. The Toolik Field Station is a research station operated and managed by the Institute of Arctic Biology at the University of Alaska Fairbanks with cooperative agreement support from the Division of Polar Programs, Directorate for Geosciences at the National Science Foundation (NSF).\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# import necessary libraries\nlibrary(here)\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(readr)\nlibrary(gt)\nlibrary(tufte)\nlibrary(feasts)\nlibrary(tsibble)\nlibrary(sjPlot)\n```\n:::\n\n\n[Soil Temperature]{.underline}\n\nSoil Temperature data was accessed from the publicly available Meteorological Data Query from Lake Toolik Field Station. The soil temperature marker utilized for this analysis was the soil temperature for the first 150 cm of the soil profile. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load data that has soil temperature in degrees Celcius for first 150 cm\nsoil <- read_csv(here(\"blog-posts\", \"2023-12-10-permafrost-black-carbon\", \"data\",\"3-hour_data.csv\"))\n\n# create updated soil temperature df\nsoil_2 <- soil %>% \n  # choose all values recorded at hour 300\n  filter(hour == \"300\") %>%\n  # remove hour column\n  subset(select = -hour) %>%\n  # rename column for readability\n  rename(soil_temp = soil1_150cm) \n```\n:::\n\n\n[Air Temperature]{.underline}\n\nAir Temperature data was accessed from the publicly available Meteorological Data Query from Lake Toolik Field Station. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load data that contains air temperature in degrees celcius for Toolik Field Station, Alaska\nair_temp <- read_csv(here(\"blog-posts\", \"2023-12-10-permafrost-black-carbon\", \"data\", \"24-hour_data.csv\"))\n\n# create updated air temperature df\nair_temp_updated <- air_temp %>% \n  select(air_temp_max_3m, date) %>% # select columns to keep\n  rename(air_temp = air_temp_max_3m) # rename air_temp for readability\n```\n:::\n\n\n[Black Carbon]{.underline}\n\nBlack Carbon data was accessed from a citizen science \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load data that contains pm2.5 which will be used as a representation of black carbon\nblack_carbon <- read_csv(here(\"blog-posts\", \"2023-12-10-permafrost-black-carbon\", \"data\", \"us-epa-pm25-aqi.csv\"))\n\n# black carbon date information is stored as POSIXct so switch to date type\nblack_carbon$DateTime <- as.Date(black_carbon$DateTime) \n\n# create updated black carbon dataframe\nblack_carbon_2 <- black_carbon %>% \n  # rename date column to match other df's\n  rename(date = DateTime) %>%  \n  # average the two field station measurements\n  mutate(b_c = (`Toolik Field Station A`+`Toolik Field Station B`)/2) %>% \n  # b_c is not normally distributed so take log to correct for this\n  mutate(log_b_c = (log(b_c)+1)) %>% \n  # remove unecessary columns\n  subset(select = -c(Average,`Toolik Field Station A`, `Toolik Field Station B`))  \n  \n# change -Inf values created by log function to 0 to allow regressions to run\nblack_carbon_2$log_b_c[black_carbon_2$log_b_c == -Inf] <- 0 \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create new df containing black carbon and soil temp data\ncombined_bc_st <- left_join(black_carbon_2, soil_2, by = 'date')\n\n# create new df with black carbon, soil temp, and air temp data\nfull <- left_join(combined_bc_st, air_temp_updated, by = 'date') %>% \n  drop_na() # remove na values \n```\n:::\n\n\n## Exploratory Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot relationship between air temperature and soil temperature\nggplot(data = full, aes(x = air_temp, y = soil_temp)) +\n  geom_point() +\n  theme_minimal() +\n  geom_smooth(method = lm) +\n  labs(x = \"Air Temperature Degrees Celcius\", y = \"Soil Temperature Degrees Celcius\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot relationship between black carbon and soil temp\nggplot(data = full, aes(x = b_c, y = soil_temp)) +\n  geom_point() +\n  theme_minimal() +\n  geom_smooth(method = lm) +\n  labs(x = \"PM2.5 (ppm)\", y = \"Soil Temperature Degrees Celcius\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# clustering of data, use a histogram to examine the distribution\nhist(full$b_c, xlab = 'PM2.5 (ppm)', main = 'Distribution of Black Carbon levels')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# re-examine black carbon with a log transformation applied to see if relationship improves\nggplot(data = full, aes(x = log_b_c, y = soil_temp)) +\n  geom_point() +\n  theme_minimal() +\n  geom_smooth(method = lm) +\n  labs(x = \"PM2.5 (ppm)\", y = \"Soil Temperature Degrees Celcius\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# examine distribution of log transformed black carbon levels\nhist(full$log_b_c, xlab = 'log(PM2.5) (ppm)', main = 'Distribution of Black Carbon levels')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n\n## Linear Regression and Hypothesis Testing\n\nThe additive linear equation model is: $$ soiltemp_i=\\beta_{0}+\\beta_{1} \\cdot airtemp_i + \\beta_{2} \\cdot log(black carbon)_i + \\varepsilon_i $$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run linear regression on soil temp using air temp and black carbon as predictors\npermafrost_mod_2 <- summary(lm(soil_temp ~ air_temp + log_b_c, data = full))\nprint(permafrost_mod_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = soil_temp ~ air_temp + log_b_c, data = full)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.2638 -1.5051  0.6854  1.7487  3.5257 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.90993    0.38016  -2.394   0.0179 *  \nair_temp     0.07944    0.01369   5.804 3.84e-08 ***\nlog_b_c     -0.30360    0.15458  -1.964   0.0514 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.307 on 147 degrees of freedom\nMultiple R-squared:  0.1922,\tAdjusted R-squared:  0.1812 \nF-statistic: 17.48 on 2 and 147 DF,  p-value: 1.542e-07\n```\n:::\n:::\n\n\nThe interaction equation model is:\n\n$$ soiltemp_i=\\beta_{0}+\\beta_{1} \\cdot airtemp_i + \\beta_{2} \\cdot log(black carbon)_i + \\beta_{3} \\cdot airtemp_i \\cdot log(blackcarbon)_i + \\varepsilon_i $$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run linear regression on soil temp using air temp and black carbon as well as an interaction between black carbon and air temperature\npermafrost_mod_3 <- lm(soil_temp ~ air_temp + log_b_c + air_temp:log_b_c, data = full)\npermafrost_mod_3_summ <- summary(permafrost_mod_3)\n\n# create a table with results displayed from interaction model\npermafrost_table <- permafrost_mod_3 %>%\n  tab_model()\n\npermafrost_table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">soil temp</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.61&nbsp;&ndash;&nbsp;-0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.041</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">air temp</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.01&nbsp;&ndash;&nbsp;0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.079</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">log b c</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.70&nbsp;&ndash;&nbsp;-0.02</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.036</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">air temp √ó log b c</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.02&nbsp;&ndash;&nbsp;0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.430</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">150</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.196 / 0.179</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n## Decomposition\n\n## Takeaways\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}